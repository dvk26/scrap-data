\documentclass[twocolumn,showpacs,preprintnumbers,prc,superscriptaddress]{revtex4-2}
\usepackage{graphicx,color}
\usepackage{float}
\usepackage{amsmath}
\usepackage{bm}
%\uspackage[noend][algpseudocode]
\usepackage{tkz-berge,tikz}
\usepackage[qm,braket]{qcircuit}

\usepackage[pdftex,colorlinks=true, linkcolor = blue, citecolor=blue,urlcolor=blue, bookmarksnumbered=true, bookmarksopen=true]{hyperref}
\usepackage{appendix}
\usepackage{soul}
%\usepackage{}

\newcommand{\aleb}[1]{\textsf{\color{blue}{\textsuperscript{AB}#1}}}
\newcommand{\joe}[1]{\textsf{\color{green}{\textsuperscript{JC}#1}}}
\newcommand{\alebCom}[1]{\textsf{\color{orange}
{\textsuperscript{ABCom}#1}}}
\usepackage[normalem]{ulem}
\newcommand{\REFER}[1]{\textsf{\color{red}{[NEED REFS]#1}}}
\newcommand{\red}[1]{\textcolor{red}{#1}}

\newcommand{\bs}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bea}{\begin{align}}
\newcommand{\eea}{\end{align}}

\begin{document}

\title{Reaction dynamics with qubit-efficient momentum-space mapping}

\author{R. Weiss}
\affiliation{
  Los Alamos National Laboratory, Theoretical Division, Los Alamos, New Mexico 87545, USA}
\author{A. Baroni}
\affiliation{National Center for Computational Sciences, Oak Ridge National Laboratory, TN 37831, USA}
\author{J. Carlson}
\affiliation{
  Los Alamos National Laboratory, Theoretical Division, Los Alamos, New Mexico 87545, USA}
\author{I. Stetcu}
\affiliation{
  Los Alamos National Laboratory, Theoretical Division, Los Alamos, New Mexico 87545, USA}
  
\date{\today}
\preprint{LA-UR-24-20333}

\begin{abstract}
    Description of quantum many-body dynamics is extremely challenging on classical computers, as it can involve many degrees of freedom. On the other hand, the time evolution of quantum states is a natural application for quantum computers, which are designed to efficiently perform unitary transformations. In this paper we study quantum algorithms for response functions, relevant for describing different reactions governed by linear response. We consider a qubit-efficient mapping on a lattice, which can be efficiently performed  using momentum-space basis states. 
    We analyze the advantages and disadvantages of this approach, focusing on the nuclear two-body system and a typical response function relevant for electron scattering as an example. We investigate ground-state preparation, controlled time evolution and 
    the required measurements.  We examine circuit depth and the hardware noise level required to 
    interpret the signal. 
\end{abstract}

\maketitle


\section{Introduction}

Quantum computing has the potential to become one of the most powerful methods for calculating the dynamics of many-body quantum systems. As hardware continues to improve, it is vital to develop appropriate quantum algorithms. In various studies, relevant aspects of quantum computation have been examined. Various methods for mapping Hamiltonians to qubits have been investigated \cite{JW,BRAVYI2002210,Tavernelli:2016ckh,Bravyi:2017eoo,Babbush:2017oum,Steudtner:2018ujo,DiMatteo:2020dhe,Kirby:2021vkt,PhysRevResearch.4.023154}, considering the trade-offs with respect to the number of required qubits and number of Pauli strings in the Hamiltonian, or circuit depth for different algorithms. Preparing specific states on a quantum computer is a necessary step for the description of many-body systems. Indeed, different ground-state preparation methods, including variational algorithms \cite{Kandala:2017HE,Tilly:2021}, adiabatic evolution \cite{Farhi2000,Albash2018}, and projection-based methods \cite{Motta:2020,PhysRevResearch.4.033121,Turro2022,Jouzdani2022,Ge2018,Dong2022,Keen2021,Choi2021, Stetcu:2022nhy}, have been developed, as well as algorithms for initialization to a known state \cite{Bergholm:2005ibb,Plesch:2011vwn,Zhang:2021uwi,Zhang:2021bue,Rosenthal:2021rcb,Zhang:2022pue,Sun:2023bwt}.

% references for state initialization algoriths:
% without ancilla qubits:  
% Sun:2023bwt (optimal), Bergholm:2005ibb, Plesch:2011vwn
% improved using ancillary qubits:
% Zhang:2022pue, Zhang:2021uwi, Zhang:2021bue, Rosenthal:2021rcb,


In scientific computing for nuclear physics, quantum computers should be especially useful for calculating reaction cross sections. For example, exact calculations of exclusive electron- and neutrino-scattering are not accessible with classical computers, even for relatively light nuclei. Several algorithms for response functions have been suggested \cite{Terhal:1998yh,Lidar:1998mf,Ortiz:2000gc,Soma-SpectrumState,Kassal_2008,Rogerro2019,Somma:2019rmm,Roggero:2020qoz,PhysRevA.102.022408}. This might be an early application of quantum computers, but significant algorithmic progress is still needed \cite{Roggero:2019myu}. In many cases, the steps requiring the most resources in such algorithms involve time evolution of a given state. Trotter-based time evolution and the associated uncertainty estimation have been studied in different works \cite{Trotter1959,Suzuki:1985wzj,Lloyd1996,Heyl_2019,Kivlichan_2020,Childs:2019hts,Tran_2020,Sieberer:2019htd,Layden:2021ols}, as well as other approaches \cite{Berry_2015,Berry:2014ivo,Low:2016sck,Low:2016znh}. 


In this work, we study the description of quantum many-body systems on a lattice using quantum computing, with focus on dynamical processes and reactions. In Sec. \ref{sec:Ham_Map}, we discuss different possible mappings, analyzing the number of required qubits and Pauli strings in the Hamiltonian. Our analysis suggests an advantage for a qubit-efficient momentum-space mapping over the Jordan-Wigner mapping, at least for small number of particles. Considering this mapping, we focus in the reminder of the paper on a simplified two-body problem with a contact interaction. The mapping of the two-body Hamiltonian is presented in Sec. \ref{sec:2body}, and time evolution with optimized quantum circuits, using both first-order and second-order Trotter approximation, is discussed in Sec. \ref{sec:time_evo}. We consider different approaches for ground-state preparation in Sec. \ref{sec:GS_prep}. We analyze an energy-filter method, and also present a new approach for state initialization, assuming the ground state is known. For the latter, the gate depth scales polynomially with the number of qubits and $1/\epsilon$, where $\epsilon$ is the error associated with the resulting state compared to the desired state. Finally, combining these different ingredients, we study a response function algorithm and analyze the required circuit depth in Sec. \ref{sec:res_func}, investigate the impact of noise in Sec. \ref{sec:noise}, and summarize in Sec. \ref{sec:summary}.



\section{Hamiltonian and Mapping}
\label{sec:Ham_Map}

We consider a fermionic non-relativistic many-body system with a two-body interaction. We will describe it using a cubic three-dimensional lattice with periodic boundary conditions. The side lengths of the lattice are denoted by $L_x$, $L_y$, and $L_z$, with $N_x$, $N_y$, and $N_z$ sites along each direction, all assumed to be even. The total number of sites is  $N = N_x N_y N_z$ and the lattice volume is $\Omega=L_x L_y L_z$. We will use momentum basis states $|\bs{p}\rangle = |p_x,p_y,p_z\rangle$. On the lattice, $p_x$ can take the values $\{0,\pm \frac{2\pi}{L_x},\pm 2\frac{2\pi}{L_x},...,\pm (\frac{N_x}{2}-1) \frac{2\pi}{L_x}, -\frac{N_x}{2} \frac{2\pi}{L_x} \}$, and similarly for $y$ and $z$.

We assume a local radial two-body interaction $V$, such that the Hamiltonian is given by the sum of kinetic and potential energy
\be \label{eq:Ham}
{\cal H} = \sum_{i=1}^A \frac{p_i^2}{2m}+\sum_{i<j}V(|\bs{r}_i-\bs{r}_j|).
\ee
Here, $A$ is the number of particles, $p_i$ is the momentum operator of particle $i$ and $m$ is the mass of the particles. To be specific, we consider the case of nuclear systems, where each particle can be either a proton or a neutron, corresponding to isospin-half particles ($t=1/2$) with isospin projection $t_z=\pm 1/2$. They also contain a spin-half ($s=1/2$, $s_z=\pm1/2$) degree of freedom. For simplicity, we use a spin-isospin independent interaction. Extensions to other interactions will be considered in future works.


The first step in describing such a system on a quantum computer is mapping the Hamiltonian to qubits. We consider first the Jordan-Wigner (JW) mapping \cite{JW}. This mapping is relevant for ferminoic Hamiltonian in second quantization. The above Hamiltonian can be written in second quantization as
\be
{\cal H} = \sum_a \frac{p_a^2}{2m} a^\dagger a
+ \sum_{a<b, c<d} V_{abcd} a^\dagger b^\dagger d c,
\ee
where $V_{abcd}=\langle a b | V | c d \rangle$, and the creation and annihilation operators correspond to the momentum basis states together with the spin-isospin degrees of freedom $|a\rangle = |\bs{p}^a s_z^a t_z^a \rangle$. There are $4N$ different creation operators, and, therefore, JW mapping for this problem involves $4N$ qubits, hence scaling as the lattice volume. Each operator is mapped to Pauli strings, i.e. tensor products of Pauli matrices, according to
\be \label{eq:JW_mapping}
a_\alpha = \left( \prod_{\beta=0}^{\alpha-1}Z_\beta\right) \frac{X_\alpha+iY_\alpha}{2},
\ee
where the operators are organized at some order from $0$ to $4N-1$, and $X_\alpha$, $Y_\alpha$, and $Z_\alpha$ correspond to the Pauli $x$, $y$, and $z$ matrices acting on qubit $\alpha$ (the identity operator is suppressed). 

Under this mapping, ${\cal H}$ is written as a sum of Pauli strings $\sum_i h_i S_i$, where $S_i$ are the Pauli strings and $h_i$ are numerical coefficients. We can now estimate how many different Pauli strings are obtained under the above JW transformation.  The main contribution comes from the two-body interaction. Due to center-of-mass (CM) momentum conservation, $V_{abcd}=0$ if $\bs{p}_a+\bs{p}_b \neq \bs{p}_c+\bs{p}_d$. In addition, as V is spin and isospin independent, we must have $s_z^a=s_z^c$ and $s_z^b=s_z^d$, or else $V_{abcd}=0$. We assume here at the moment that all other matrix elements are non-zero. The term $a^\dagger b^\dagger d c$ leads to 16 different Pauli strings (based on Eq. \eqref{eq:JW_mapping}). Therefore, we obtain $O(N^3)$ Pauli strings in the JW mapping of ${\cal H}$. If coordinate-space orbitals corresponding to the lattice sites are used, $O(N^2)$ Pauli strings are obtained for a local potential, and $O(N^3)$ for a non-local potential. For short-range potentials, if only a limited neighborhood of each lattice site is affected, the scaling with $N$ is further improved. The contribution of the kinetic term is $O(N)$ Pauli strings, with both the momentum space and coordinate space orbitals \cite{Roggero:2019myu}. 


% we have ${4N \choose 2}$ ways to choose $a$ and $b$. Then, the spin and isospin projections of $c$ and $d$ is fixed. Finally, there are $N$ options to choose the momentum $\bs{p}^c$, and the momentum $\bs{p}^d$ is fixed by CM conservation. This leads to a total of $8N^3-2N^2$ contributions. The term $a^\dagger b^\dagger d c$ leads to 16 different Pauli strings (based on Eq. \eqref{eq:JW_mapping}), so we obtain $128N^3-16N^2$ Pauli strings. There is small correction to this estimation. If $(s_z^c,t_z^c)=(s_z^d,t_z^d)$, then we need to make sure that $\bs{p}^c\neq\bs{p}^d$ (because only $c\neq d$ contributes), so we do not have exactly $N$ options to choose $\bs{p}^c$. This results in a correction of the order $O(N^2)$. The number of Pauli strings due to the kinetic part is of the order $O(N)$. So finally, we should have $128N^3+O(N^2)$ strings in the JW mapping of ${\cal H}$. 



We can also consider a qubit-efficient mapping of the Hamiltonian, similar to the encodings discussed in Refs. \cite{DiMatteo:2020dhe,PhysRevResearch.4.023154}. In this mapping, we start by choosing a relevant set of basis functions. Working with momentum states, and for the case of $A$ particles, the basis states are constructed by choosing the momentum of the first $A-1$ particles, while the momentum of the last particle is fixed by requiring zero total CM momentum. This allows us to consider only the space of zero-CM $A$-particle states, unlike the JW mapping, where the number of particles and the CM momentum are not restricted. For small systems of up to 2 protons and 2 neutrons, we do not need to consider explicitly the spin-isospin degrees of freedom. We can consider symmetric states in momentum space, and anti-symmetrization is obtained from the spin-isospin part. In this case we have $N^{A-1}$ basis states, and the number of required qubits is 
\be \label{eq:n_q}
n_q=\lceil \log_2(N^{A-1}) \rceil
=  \lceil (A-1) \log_2(N) \rceil.
\ee
The number of qubits scales logarithmically with the number of sites, unlike the linear scaling for the JW mapping. But notice that here the number of qubits depends also on the number of particles. For simplicity we will assume that $N$ is a power of $2$, and, therefore, the ceiling function is not needed in Eq. \eqref{eq:n_q}.

The mapping is defined by associating each of the many-body basis states with a different bit-string vector of $n_q$ digits (0 or 1). The latter are basis states of the $n_q$-qubit system. The Hamiltonian can be written using the physical basis states $\{|v_i\rangle\}$
\be
{\cal H} = \sum_{i,j} \langle v_j | {\cal H} | v_i \rangle |v_j\rangle \langle v_i |.
\ee
In its mapping, the operators $|v_j\rangle \langle v_i |$ should be consistently mapped. This is done using the following relations for the qubit states \cite{PhysRevResearch.4.023154}:
\begin{align} \label{eq:mapping}
|0\rangle \langle 0| &= \frac{1}{2}(I+Z) 
\; \; ; \; \;
|1\rangle \langle 1| = \frac{1}{2}(I-Z)
\nonumber \\
|1\rangle \langle 0| &= \frac{1}{2}(X-iY)
\; \; ; \; \;
|0\rangle \langle 1| = \frac{1}{2}(X+iY),
\end{align}
where $I$ is the two-by-two identity matrix. These relations are obtained under the convention that $|0\rangle = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$ and $|1\rangle = \begin{pmatrix} 0 \\ 1 \end{pmatrix}$.

We can estimate the number of Pauli strings obtained in this mapping by looking first on the kinetic part. Since we work with momentum basis states, the kinetic energy matrix is diagonal. Therefore, only $I$ and $Z$ matrices can be obtained in its mapping, i.e. at most $2^{n_q}=N^{A-1}$ Pauli strings. All these strings are commuting with each other. We will see later in an explicit example that eventually much fewer strings are obtained for the kinetic energy due to symmetries of the matrix, and we expect this contribution to be small compared to the contribution of the two-body interaction.

To deal with the potential energy, it is illustrating to start with the two-body case. For two particles, the zero-CM-momentum basis states are of the form $|\bs{k},-\bs{k}\rangle$, $N$ states in total. Therefore, mapping the potential energy matrix results in at most $4^{\log_2(N)}=N^2$, due to the 4 possible matrices ($X,Y,Z,I$) for each qubit. Considering now $A$ particles, we can look on the interaction operator $V_{12}$ that acts on particles $1$ and $2$. Notice that this operator can only connect states with the same two-body CM momentum $\bs{k}_1+\bs{k}_2$, and does not change the momentum of the remaining particles. We can order the basis states in the following way. For the first $N$ states, we choose fixed values for $\bs{k}_3,...,\bs{k}_A$, and go over all possible $N$ values of $\bs{k}_1$, while $\bs{k}_2$ is fixed by the requirement that the total CM momentum is zero, i.e. $\bs{k}_1+\bs{k_2} = -\sum_{i\geq 3} \bs{k}_i$. Then, a different set of $\bs{k}_3,...,\bs{k}_A$ is chosen, and so on. Under this choice, $V_{12}$ has a block-diagonal structure of $N^{A-2}$ $N\times N$ identical blocks. They are identical because the matrix elements of the interaction $\langle \bs{k_1}' \bs{k_2}' | V_{12} |\bs{k_1} \bs{k_2} \rangle$ depend only on the momentum transfer $|\bs{k_1}'-\bs{k_1}|$. As mentioned before, a single $N\times N$ block requires at most $N^2$ Pauli strings. Now, the full matrix is obtained by a tensor product of the $N^{A-2} \times N^{A-2}$ identity matrix and this $N\times N$ block. Therefore, for the $A$-body case, the Pauli strings obtained in the mapping of $V_{12}$ all begin with $II...I$ ($(A-2)\log_2(N)$ times) followed by the same Pauli strings obtained in the two-body case for $V_{12}$ (of length $\log_2(N)$ each, giving Pauli strings of total length $(A-1)\log_2(N)$). These are still at most $N^2$ strings. For the remaining $V_{ij}$ operators, each should have a block-diagonal structure if the order of the basis states is changed accordingly. Therefore, we expect each of them to result in at most $N^2$ Pauli strings as well. In total, the two-body interaction contributes no more than ${A \choose 2} N^2$ Pauli strings. 

As mentioned above, this is expected to be the dominant contribution. Notice the $N^2$ scaling, compared to the $N^3$ or $N^2$ scaling for the JW case (using momentum- or coordinate-space orbitals). For small number of particles, for which the factor ${A \choose 2}$ is not significant, and for a large lattice (i.e. large values of $N$), the number of Pauli strings involved in this qubit-efficient mapping should be smaller or comparable to the JW case, although for a larger number of particles the situation can change \cite{Li:2023eyg}. This is on top of the reduction in the number of qubits. We will continue investigating this mapping in the next sections, focusing on a two-body system with a contact two-body interaction as a test case.
One possible disadvantage of this mapping is the possibly large entanglement between qubits, due to Pauli strings that include many non-I Pauli matrices. This, in principle, can lead to deep circuits in the execution of time evolution. We will discuss how such circuit length can be significantly shortened. 

\section{The two-body system}
\label{sec:2body}

In the rest of this paper we will focus on the two-body system. To be specific we will consider the deuteron, i.e. the bound state of a proton and a neutron, but the general ideas are relevant for other non-relativistic quantum systems. For this purpose we will consider an $8\times 8\times 8$ lattice, i.e. $N_x=N_y=N_z=8$, $N=512$, with distance of $a=1$ fm between two adjacent sites, i.e. $L_x=L_y=L_z=8$ fm. The number of qubits required to simulate this system using the above qubit-efficient mapping is $n_q=9$. Using JW mapping would require $2048$ qubits.


We model the interaction between the two particles using a contact interaction. Such an interaction acts only between two particles that are on the same site, i.e. $V=V_0 \delta(\bs{r})$. This is the interaction obtained in pionless effective field theory at leading order \cite{Bedaque:2002mn,Hammer:2019poc,VANKOLCK1999273,CHEN1999386}. Finite-range interactions could be considered in the future. $V_0$ can be tuned to obtain the binding energy of the system, for example. In our case we choose $V_0=-235$ MeV. For fixed $a=1$ fm, and in the limit of infinite lattice, this leads to binding energy of approximately $2.2$ MeV, in agreement with the experimental value for the deuteron. For the finite value of $L_x=L_y=L_z=8$ fm, the binding energy is $4.375$ MeV. The exact value used for $V_0$ is not important for the general results and conclusion of this work. 

The Hamiltonian matrix can now be constructed using two-body momentum basis states of the form $|\bs{k},-\bs{k}\rangle$, and mapped to Pauli strings. Following the relations in Eq. \eqref{eq:mapping}, and using a specific order of the basis states (see more details in Appendix \ref{sec:app_order_states}), the kinetic part translates to $19$ Pauli strings involving no more than two $Z$ matrices per string, and they all commute with each other. Notice that this is indeed much smaller than the number of all strings with $I$ and $Z$, $2^9=512$, as discussed in the previous section. 
The contact two-body interaction is a constant in momentum space, i.e. proportional to the all-ones $N\times N$ matrix. Since,
\be
X+I = \begin{bmatrix} 1 1 \\ 1 1 \end{bmatrix},
\ee
the all-ones $N\times N$ matrix is obtained as $(X+I)^{\otimes n_q}$. Therefore, the two-body contact interaction translates to all $N$ Pauli strings with $X$ and $I$ matrices. They all come with the same coefficient of $V_0/N$, and they all commute with each other. Notice that in this case, the number of Pauli strings is linear with $N$, as opposed to the $N^2$ scaling of a general interaction in this mapping. We have here $512$ strings due to the interaction, and a total of $530$ Pauli string for the whole Hamiltonian (the all-$I$ string appears in both the kinetic and potential contributions). A JW mapping of a Hamiltonian with a contact interaction also results in a number of Pauli strings that scales linearly with the lattice size, but the number of groups of commuting strings is larger than two \cite{Roggero:2019myu}.


\section{Time evolution} \label{sec:time_evo}

Time evolution is an important part of different algorithms relevant for describing quantum systems, including ground-state preparation and cross section calculations. We will consider here time evolution based on the Trotter approximation \cite{Trotter1959,Suzuki:1985wzj,Lloyd1996}. In this approach, time evolution over time $t$, i.e., the operator $\exp(-i{\cal H}t)$, is divided to short time steps $dt=t/r$ involving $r$ Trotter steps. Since, in our case, the kinetic energy $T$ translates to a set of commuting Pauli strings, and the same for the potential energy $V$, we only need to consider the operators $\exp(-iT dt)$ and $\exp(-iV dt)$.

Starting with $T$, we can write
\be \label{eq:T_evol}
e^{-iT dt}=\prod_{S_j \in T} e^{-i \alpha_j S_j dt},
\ee
where $S_j$ are the strings in the mapping of $T$, and $\alpha_j$ are the corresponding numerical coefficients. Each operator $\exp(-i\alpha S dt)$, with $k$ non-$I$ elements in the string $S$, can be performed using a simple quantum circuit, involving a ladder of $2(k-1)$ controlled-NOT (CNOT) gates and a single $Z$-rotation \cite{Wecker:2014vsy}. For the lattice parameters chosen in this work, it results in a circuit with $18$ CNOTs and $18$ $Z$-Rotations for the exact application of the operator $\exp(-iT dt)$.

As mentioned before, the operator $V$ translates to all $2^{n_q}=512$ $9$-qubit strings built from the $X$ and $I$ matrices with the same numerical coefficient. We can, therefore, write
\be \label{Eq:VtoD}
e^{-iV dt} = H^{\otimes n_q} e^{-iD dt} H^{\otimes n_q},
\ee
where $H^{\otimes n_q}$ is the tensor product of Hadamard gates, and $D$ is a diagonal matrix in momentum space. Thanks to the identity $HZH=X$, the mapping of $D$ to Pauli strings is identical to $V$, only with $Z$ matrices instead of $X$. 
$\exp(-iD dt)$ can be written similarly to Eq. \eqref{eq:T_evol}. 
Following naively the same idea of CNOT ladders results in $2-2^{n_q+1}+n_q2^{n_q}=3,586$ CNOT gates and $2^{n_q}-1=511$ rotations \cite{Welch_2014}. But, CNOTs coming from neighboring Pauli strings can cancel as CNOT$^2=1$. This depends on the order of Pauli strings used in the implementation of time evolution. Following Ref. \cite{Welch_2014}, the Pauli strings can be ordered based on the Grey Code. Then, using commutation properties of CNOT gates, we obtain a circuit that includes only a single CNOT between two adjacent $Z$-rotations, with a total of $2^{n_q}-2=510$ CNOTs and $2^{n_q}-1=511$ $Z$-rotations in the exact application of $\exp(-iV dt)$ (together with 9 Hadamard gates at the beginning and at the end of the circuit, Eq. \eqref{Eq:VtoD}). We can see that despite the fact that $V$ includes Pauli strings with many non-$I$ elements (e.g., the all-$X$ string), the final number of CNOTs per Pauli string is relatively small due to CNOT cancellations.

These elements are combined to obtain the total time evolution. Using first-order trotter approximation with $r$ trotter steps we obtain
\be \label{eq:1st_trotter}
e^{-i{\cal H}t} \approx \left(e^{-iV dt} e^{-iT dt} \right)^r \equiv U_1(dt)^r
\ee
The order of $T$ and $V$ can be reversed. In this approach we get 
528 CNOTs and 529 $Z$-rotations per trotter step. We can also consider second-order trotter approximation, which results in the expression
\be \label{eq:2nd_trotter}
e^{-i{\cal H}t} \approx \left(e^{-iT \frac{dt}{2}} e^{-iV dt} e^{-iT \frac{dt}{2}} \right)^r
\equiv U_2(dt)^r.
\ee
Notice that the first-order and seconder-order expressions differ only at the very beginning and end of the circuit because $\exp(-iTdt/2)\exp(-iTdt/2) = \exp(-iTdt)$ \cite{Layden:2021ols}. Therefore, the full circuit corresponding to \textit{total} time evolution $t$ with second-order approximation includes only $18$ additional CNOTs and $18$ additional $Z$-rotations, compared to the first-order approximation circuit, independent of the number of trotter steps. 

Despite the similarity between the two circuits, one can obtain a non-negligible improvement using the second-order approximation \cite{Layden:2021ols}. We can compare the two by considering the effective Hamiltonian corresponding to each case. The effective Hamiltonian is defined such that the Trotter-approximated time evolution with the original Hamiltonian corresponds to exact time evolution under the effective Hamiltonian, namely \cite{Wecker:2014vsy}
\be
{\cal H}^{\mathrm{eff}}_j = \frac{\ln\left(U_j(dt)\right)}{-i dt},
\ee
for $j=1,2$. 
We compare in Fig. \ref{fig:E_eff} the energy spectrum of these effective Hamiltonians for $dt=0.002$ with respect to the exact energy spectrum. We can see that the error in the energies when using second-order Trotter approximation, compared to first-order approximation, is smaller by about a factor of about $4$ throughout the whole energy domain. Notice also that the error seems to be larger for the smallest energies. There are several energies for which the error is zero. This is a special property of the two-body system with a contact interaction, for which the negative-parity eigenstates are non-interacting free states. For these states the Trotter approximation is exact. In any case, we see that second-order approximation indeed provides better description of the exact time evolution. Since the added complexity to the corresponding circuit is negligible (compared to first-order Trotter approximation) it is beneficial to implement this method.


\begin{figure} \begin{center} 
\includegraphics[width=\linewidth]{effective_energy_Trotter_NoAbs.pdf}
\caption{\label{fig:E_eff}
The difference between the eigenvalues (i.e., energies) of the Trotter effective Hamiltonians and exact Hamiltonian. For each Hamiltonian, the eigenvalues are ordered from smallest to largest. The difference is presented as a function of the corresponding exact energy. Results for both first-order and second-order Trotter approximation with $dt=0.002$ are shown.}
\end{center}\end{figure}


\section{Ground-state preparation}\
\label{sec:GS_prep}

As mentioned before, the first step of many quantum algorithms is the preparation of a desired initial state on the quantum computer. Here we will focus on the ground state of the Hamiltonian. We will discuss and analyze two methods. First, we analyze the complexity of the projection-based energy-filtering approach of Ref. \cite{Stetcu:2022nhy}, where only limited information regarding the ground-state and energy spectrum is assumed to be known. Next, assuming the ground-state wave function is known, we present a new method for preparing this state on the computer. We analyze the success probability and gate complexity. 

\subsection{Measurement-based energy filter}
\label{subsec:energy_filter}

We will first consider here the projection-based approach of Ref. \cite{Stetcu:2022nhy}. The first step is to initialize the system to a state $|\psi_i\rangle$, preferably with significant overlap with the exact ground state $|\Psi_0\rangle$. We assume $\langle \Psi_0 | \Psi_0 \rangle=\langle \psi_i | \psi_i \rangle=1$. In our case, we consider the state in which the two particles have zero momentum. It simply corresponds to the all-zero $9$-qubit state with the mapping used here, and obeys $|\langle \psi_i | \Psi_0 \rangle|^2 \approx 0.75$. Using ancillary qubit $a$ in state $|0\rangle$, the initial state is $|\psi_i\rangle \otimes |0\rangle$. Then, time evolution operator of the form $\exp[-i({\cal H}-E_0 I_N) t \otimes Y_a]$ is applied, where $E_0$ is the ground-state energy, $I_N$ is the $N \times N$ identity matrix, and $Y_a$ is the Y Pauli matrix acting on the ancillary qubit. In principle, a phase can also be included \cite{Stetcu:2022nhy}, but we will not utilize this freedom here. If we then read qubit $a$ to be in state $|0\rangle$, the system is projected to the state ${\cal N}\cos[({\cal H}-E_0 I_N)t]|\psi_i \rangle$, where ${\cal N}$ is a normalization factor. This happens with probability $\langle \psi_i | \cos^2[({\cal H}-E_0 I_N)t]|\psi_i \rangle$. We can try to choose the time $t$ to get close to the ground state $|\Psi_0\rangle$. We assume to know the energy gap $\Delta$ between the ground state and the first excited state of the Hamiltonian, and choose the time $t_\Delta\equiv\frac{\pi}{2\Delta}$. As a result, the first excited state is exactly projected out from the initial state. In our case $\Delta=13.5$ MeV. The average energy of the initial state is $\langle \psi_i | {\cal H} | \psi_i \rangle \approx -0.46$. After projection with time $t_\Delta$, the average energy of the state, denoted by $\psi_\Delta$, is $-4.19$ MeV, less than $5\%$ difference compared to the exact ground-state energy. The success probability for producing $\psi_\Delta$, i.e. measuring the ancillary qubit in state $|0\rangle$, is approximately $75\%$, and $|\langle \psi_\Delta | \Psi_0 \rangle|^2 \approx 0.9988$. We can see that, by projecting-out the first excited state, we obtain a good approximation for the ground state. This can be improved by performing additional projections with different values for the time $t$ \cite{Stetcu:2022nhy}. 

To apply this algorithm on a quantum computer, a Trotter approximation can be used, similar to the discussion in Section \ref{sec:time_evo} (see Appendix \ref{sec:app_energy_filter} for more technical details). 
We study the convergence of such a calculation with respect to the number of Trotter steps Fig. \ref{fig:gap_projection}. We can see that, as the number of Trotter steps becomes larger, the energy of the resulting state converges to the value obtained using the exact projection ($-4.19$ MeV). We compare the use of first-order and second-order Trotter approximations, as well as the order of the operators, i.e. as in Eqs. \eqref{eq:1st_trotter} and \eqref{eq:2nd_trotter}, or if $V$ and $T$ are replaced. We can generally see that the use of second-order approximation leads to faster convergence compared to the first order. Moreover, we see that one order of operators in the first-order approximation (orange triangles in the plot) leads to especially slow convergence. It would be interesting to try and understand the origin of this difference and its relevance to other studies, systems and algorithms. Except for this case, about $40$ Trotter steps are needed to obtain a good approximation of the time evolution. 
Following the same ideas of the Grey-Code order discussed in Section \ref{sec:time_evo}, for first-order Trotter approximation, each step involves $536$ CNOTs and $531$ $Z$-rotations. For $40$ step, this is $21440$ CNOTs and $21240$ $Z$-rotations. Second-order approximations, results in only $24$ more CNOTs and 19 more $Z$-rotations for the whole time evolution.






\begin{figure} \begin{center} 
\includegraphics[width=\linewidth]{GS_preparation_with_gap_time.pdf}
\caption{\label{fig:gap_projection}
The energy of the state obtained after the projection-based approach described in the text, as a function of the number of Trotter steps used in the time evolution. The initial state is the zero-momentum state, and the time used in the algorithm is $t_\Delta$. Results using different Trotter approximations are shown. The label 'V+T' corresponds to Eq. \eqref{eq:1st_trotter}, with the operators $V \otimes Y_a$ and $(T-E_0 I_N)\otimes Y_a$ instead of $V$ and $T$, respectively. The label 'T+V' corresponds to the opposite order. 'T+V+T' and 'V+T+V' similarly correspond to the second-order Trotter approximation (Eq. \eqref{eq:2nd_trotter}). 
The energy obtained using exact time evolution and the exact ground-state energy are also shown (dashed and dotted lines, respectively).
}
\end{center}\end{figure}



\subsection{Measurement-based state initialization}
\label{subsec:initialization}

We can also consider a case in which we know classically the exact ground state and would like to initialize a quantum computer to this state. Then, for example, reaction that cannot be calculated on a classical computer could be studied using the quantum computer. We will provide here an algorithm, with similarities to the above measurement-based approach. 

We assume that we know the expansion of the desired state using the basis states $\{|v_j\rangle \}$ defined in Section \ref{sec:Ham_Map}
\be \label{eq:gs_expan}
|\Psi_0 \rangle = \sum_j g_j |v_j \rangle,
\ee
where $g_j$ are complex numbers.
We start by initializing the qubits to a state that includes all basis states with {\it real} non-zero coefficients $\{b_j\}$
\be \label{eq:ini_state_bj}
|\psi_i \rangle = \sum_j b_j |v_j \rangle.
\ee
This can be obtained, for example, by initializing all qubits to the $|0\rangle$ state and applying Hadamard gate on each qubit.
Now, with a single ancillary qubit $a$, the initial state is assumed to be $|\psi_i\rangle \otimes |0\rangle$. Then, an operator $\exp[-i Q \otimes Y_a]$ can be applied, where 
\be \label{eq:Q_op}
Q = \sum_j d_j |v_j\rangle \langle v_j|,
\ee
for real numbers $\{d_j\}$.
If we measure the ancillary qubit in state $|0\rangle$, the system collapses to the state 
$|\psi_Q \rangle = {\cal N} \sum_j \cos(d_j) b_j |v_j \rangle$, where ${\cal N}$ is an appropriate normalization factor. The values of $d_j$ can be chosen such that we obtain the state $|\psi_Q \rangle = \sum_j |g_j| |v_j \rangle$. To get the right phase of $g_j$, we can apply the operator $\exp(i\Theta)$, where $\Theta = \sum_j \theta_j |v_j\rangle \langle v_j|$ and $g_j=|g_j|\exp(i\theta_j)$. This finally results in the desired state $|\Psi_0\rangle$.
We provide more technical details regarding this algorithm in Appendix \ref{sec:app_state_ini}, including a discussion about the success probability of this approach. 

Since $Q$ and $\Theta$ are diagonal, the corresponding quantum circuit for this algorithm is relatively simple to construct in the mapping discussed in this work. No Trotter approximation is required. 
Applying $\exp[-i Q \otimes Y_a]$ involves at most $2^{n_q}$ CNOTs and $2^{n_q}$ $Z$-rotations. If the coefficients $\{g_j\}$ are not all real, additional $2^{n_q}-2$ CNOTs and $2^{n_q}-1$ $Z$-rotations are needed to apply the operator $\exp(i\Theta)$.
%The total number of gates is at most $2^{n_q+1}-2$ CNOTs and $2^{n_q+1}-1$ $Z$-rotations.
Since we use a qubit-efficient mapping, the number of gates scales linearly with the lattice size for the two-body system, see Eq. \eqref{eq:n_q}.

We also note that it was shown in Ref. \cite{Welch_2014}, that operators like $\exp[-i Q \otimes Y_a]$ and $\exp(i\Theta)$ can be approximated using a polynomial number of one-body and two-body gates. Therefore, if we are only interested in a good approximation of the desired state, the number of gates in our algorithm will scale polynomialy with the number of qubits. 
It thus might provide an advantage over other algorithms in some cases, especially if a low success probability can be avoided. This includes algorithms that require exponential circuit depth, without any ancilla qubits or measurements \cite{Sun:2023bwt}, or 
algorithms with polynomial depth, but with possibly exponential number of ancilla qubits
%, and in some cases also exponentially small success probability 
\cite{Zhang:2021uwi,Zhang:2021bue,Rosenthal:2021rcb,Zhang:2022pue,Sun:2023bwt}.


In our specific $9$-qubit two-body problem, $512$ $Z$-rotations and CNOTs are needed for exact initialization to the ground state (all $g_j$ are real). 
If a $10\%$ accuracy on the energy is required, only $300$ $Z$-rotations and a similar number of CNOTs \cite{Welch_2014} are needed. In any case, this is a much shallower circuit compared to the method discussed in Section \ref{subsec:energy_filter}. Therefore, such a method could be useful for the description of reactions in relatively small systems, where the ground state can be solved on a classical computer. In the calculation of the response function in the next section we will indeed assume that the ground state has been prepared with such a short circuit, such that this step has a negligible contribution to the total complexity of the calculation.





\section{Response function}
\label{sec:res_func}

After discussing time evolution and ground-state preparation, we are set to discuss the calculation of response functions. We generally follow here the algorithm presented in Ref. \cite{Rogerro2019}, with some modifications. The required resources for the calculation of neutrino-nucleus scattering using this algorithms were estimated in Ref. \cite{Roggero:2019myu} with the JW mapping. We focus here on the qubit-efficient mapping in momentum space. We will repeat the main steps of the algorithm below. 

The response function is defined as
\be
S(\omega) = \sum_\nu |\langle \Psi_\nu | \hat{O} | \Psi_0 \rangle |^2 \delta(E_\nu - E_0 - \omega),
\ee
where $\hat{O}$ is a relevant transition operator, $\omega$ is the energy transfer, and $|\Psi_\nu\rangle$ is an eigenstate of the Hamiltonian with energy $E_\nu$.
We will continue to analyze here the two-body deuteron system, and consider a transition operator of the form
\be \label{Eq:O_op}
\hat{O} = e^{i \bs{q} \cdot \bs{r}_p},
\ee
transferring momentum $\bs{q}$ to the proton. $\bs{r}_p$ is the proton coordinate. Such an operator is relevant, for example, for the longitudinal response function in electron-nucleus scattering. We can separate the action of this operator to the relative and CM motion
\be
\hat{O} = e^{i \frac{\bs{q}}{2} \cdot \bs{r}} e^{i \bs{q} \cdot \bs{R}},
\ee
where $\bs{r}$ and $\bs{R}$ are the relative and CM coordinates of the pair. The response function can then be written as
\be
S(\omega) = \sum_\nu |\langle \Psi_\nu^{int} | e^{i \frac{\bs{q}}{2} \cdot \bs{r}} | \Psi_0 \rangle |^2 \delta(E_\nu^{int} + E_{CM} - E_0 - \omega),
\ee
where $E_{CM}=q^2/4m$ is the energy of the CM motion, and $|\Psi_\nu^{int}\rangle$ and $E_\nu^{int}$ are the internal wave function and energy, corresponding to the relative coordinate. This allows us to remain in the space of zero-CM states. We note that, on a lattice, the relevant values of $\bs{q}/2$ are quantized. The lowest non-zero momentum transfer in the $z$ direction obeys $q/2 = 2\pi/L_z$.

Similar to Ref. \cite{Rogerro2019}, we define a shifted and scaled Hamiltonian
\be
\bar{{\cal H}} = \frac{{\cal H}-E_0}{\Delta {\cal H}}
\ee
and energy transfer $\bar{\omega}=(\omega-E_{CM})/\Delta {\cal H}$, where $\Delta {\cal H}$ is the difference between the largest zero-CM eigenstate of ${\cal H}$ and the ground state energy. The response function corresponding to $\bar{{\cal H}}$ obeys \cite{Rogerro2019}
\be
\bar{S}(\bar{\omega}) = \Delta {\cal H} S(\omega).
\ee
Notice that $\omega\in [E_{CM},E_{CM}+\Delta {\cal H}]$ and $\bar{\omega}\in [0,1]$.
We can, therefore, focus on calculating $\bar{S}(\bar{\omega})$.

After preparing the ground state on a quantum computer, one should apply the transition operator \cite{Rogerro2019}. In our case, $\exp{(i \frac{\bs{q}}{2} \cdot \bs{r})}$ is a unitary operator. It can be applied by mapping the Hermitian operator $\frac{\bs{q}}{2} \cdot \bs{r}$ to Pauli strings, combined with Trotter approximation. Using the mapping discussed in this work, this operator, for the lowest possible non-zero momentum transfer in the $\hat{z}$ direction, translates to a small number of only $16$ strings. About $30$ Trotter steps produce an accurate result, and, therefore, the state $\exp{(i \frac{\bs{q}}{2} \cdot \bs{r})} |\Psi_0\rangle$ can be prepared with a relatively short circuit, negligible compared to the next step.

At this point, quantum phase estimation (QPE) algorithm \cite{Abrams1999,Cleve:1997dh} can be applied to obtain the response function. In this approach,
$W$ ancilla qubits are initialized to $|0\rangle$ and a Hadamard gate is applied to each of them. Then,
a series of controlled time evolution operators 
\be \label{eq:U2k}
U^{2^k} = e^{i2\pi 2^k \bar{{\cal H}}}
\ee
are applied, where $k=0,1,...,W-1$, each controlled on the corresponding $k$-th ancilla qubit. Inverse quantum Fourier transform is then applied on the ancilla qubits, and their state is measured. Repeating this process, the probability $P(a)$ of measuring a binary string corresponding to an integer number $a\in [0,2^W-1]$ provides an estimation for $\bar{S}(\bar{\omega})$, where $\bar{\omega}=a/2^W$. In total, this results in $2^W$ evenly-spaced energy values in the range $\bar{\omega}\in[0,1]$ in which $\bar{S}(\bar{\omega})$ is evaluated, i.e. with energy resolution of $2^{-W}$.

The response function corresponding to the momentum transfer operator of Eq. \eqref{Eq:O_op} is expected to have a clear quasi-elastic (QE) peak around $\omega=q^2/2m-E_0$. The strength of the response function should be negligible far enough from this peak. Therefore, we suggest here some modifications to this algorithm. Instead of the operators in Eq. \eqref{eq:U2k}, one can apply the operators
\be \label{eq:QPE_mod_op}
U^{2^k}_{\alpha,\beta} = e^{i2\pi 2^k \alpha (\bar{{\cal H}}-\beta)},
\ee
involving two real parameters $\alpha$ and $\beta$. With this definition, the probability $P(a)$ corresponds to $\bar{S}(\bar{\omega})$, with a modified relation
\be
\bar{\omega}=\frac{a}{2^W \alpha}+\beta.
\ee
Since $a\in [0,2^W-1]$, we get values of $\bar{\omega}$ in the range $\beta \leq \bar{\omega} < 1/\alpha + \beta$. Therefore, we can use $\alpha>1$ to limit the calculation to a smaller range of energies. It is important that the response function is negligible outside this energy range to get a correct result. Comparing to the original algorithm (i.e. $\alpha=1$ and $\beta=0$), this can reduce the number of ancilla qubits for a given required energy resolution, and also shorten somewhat the total time evolution (see details in Appendix \ref{sec:app_modified_QPE}). $\beta$ also allows us to shift the energy bins and control the energy values for which the response function is evaluated.

We compare these different possibilities in Fig. \ref{fig:response_exact}, where the response function $\bar{S}(\bar{\omega})$ for the lowest non-zero momentum transfer $\bs{q}= 4\pi/L_z \hat{z}$ is shown. We see that the original algorithm with $W=6$ (blue circles) provides reasonable results compared to the exact calculation, but with a slightly larger width. The $W=6$ calculation with $\beta>0$ (orange triangles) results in translated energy grid which allows us to identify the maximum of the QE peak. The green squares show the result of a $W=3$ calculation with $\alpha>1$, such that the energy grid is limited to the QE peak. These results include $8$ points, all in the relevant energy range and with slightly better resolution than the $W=6$ calculations, showing a good agreement with the exact calculations. We note that the total time evolution of the $W=3$ calculation is similar to the $W=6$ calculations, and, therefore, they should all require similar circuit depth.


\begin{figure} \begin{center}
\includegraphics[width=\linewidth]{response_function_qz_2dk_exact_vs_QubitsNoTrotter.pdf}
\caption{\label{fig:response_exact} The response function $\bar{S}(\bar{\omega})$ for the lowest non-zero momentum transfer $\bs{q}= 4\pi/L_z \hat{z} = \pi/2$ fm$^{-1} \hat{z} = 310$ MeV/c $\hat{z}$. The exact calculation (red stars) is compared to the results of the quantum algorithm described in the text, assuming exact implementation (negligible Trotter errors) and exact ground-state initialization. The blue circles correspond to a $6$-ancilla-qubit calculation with the original algorithm ($\alpha=1$, $\beta=0$). The orange triangles correspond to a $6$-ancilla-qubit calculation with translated energy grid using $\beta>0$. The green squares correspond to a 3-ancilla-qubit calculation limited to the QE peak using $\alpha>1$. The expected center of the QE peak is shown by the dashed line. Both $W=6$ calculations extend to $\bar{\omega}=1$.
}
\end{center}\end{figure}


To estimate the circuit depth we can focus on the step of controlled time evolutions, which is the most resource-demanding part of the response function calculation. It can be implemented using the Trotter approximation. As discussed in Sec. \ref{sec:time_evo}, $\exp(-i \alpha S dt)$, for a Pauli string $S$, can be performed using a ladder of CNOT gates and a single $Z$-rotation in the middle. For controlled time evolution, each $\exp(-i \alpha S dt)$ operator should be controlled as well. This can be implemented by replacing the $Z$-rotation with a controlled rotation. Each controlled $Z$-rotation can be implemented using two $Z$-rotations and two CNOTs (see, e.g., Eq. (A4) in Ref. \cite{Roggero:2019myu}). As discussed before, for our Hamiltonian and mapping, the main contribution to circuit depth comes from the time evolution of the potential energy, with about $2^{n_q}$ CNOTs and $2^{n_q}$ $Z$-rotations per Trotter step of an uncontrolled time evolution. Therefore, for a controlled time evolution, we have about  $3\cdot2^{n_q}$ CNOTs and $2^{n_q+1}$ $Z$-rotations per Trotter step (using either first or second Trotter formulas). In principle, another approximation can be made to reduce the circuit depth, by omitting Pauli strings with small numerical coefficients \cite{Welch_2014}. But, for the contact interaction used here, all Pauli strings coming from the interaction have the same coefficient. This approximation can be useful when considering other interaction models, which will be the focus of future studies.

The results of a calculation with Trotter approximation are shown in Fig. \ref{fig:response_Trotter}. We focus on the $W=3$ case. Calculations with about $100$ Trotter steps lead to  reasonable agreement with the exact $W=3$ results. In that case, the total circuit required for performing the relevant controlled time evolution with $n_q=9$ includes about $150,000$ CNOTs and $100,000$ $Z$-rotations. We note that the energy resolution of these calculations is $15$ MeV ($\Delta {\cal H} = 1232$ MeV).
% energy reolustion = energy spacing in \bar{\omega} times Delta H = 0.0122 * 1232 = 15 MeV
For heavier nuclei and larger momentum transfer, a coarser energy grid should be sufficient to describe the QE peak, which can reduce the total circuit depth. The calculations presented in this section were done assuming exact ground state preparation, but we note that similar results are obtained with approximated states. 

Different improvements could possibly allow us to obtain a shorter circuit. Using symmetries like parity could further decrease the size of the relevant Hilbert space and thus reduce the number of qubits and circuit depth. Specific finite-range potentials, perhaps combined with coordinate-space mapping instead of momentum-space mapping, might reduce the number of Pauli strings in the Hamiltonian or the number of required Trotter steps. Other available algorithms for the calculation of response function or time propagation could also lead to improvements. 



\begin{figure} \begin{center}
\includegraphics[width=\linewidth]{response_function_lowest_q_3qubits_alpha_Trotter.pdf}
\caption{\label{fig:response_Trotter}
Similar to Fig. \ref{fig:response_exact}, but including also calculations with Trotter approximation. The red stars correspond to the exact response function. The blue squares represent $W=3$ calculations with $\alpha>1$ assuming exact implementation, while orange circles and green triangles include Trotter approximation for the controlled time evolution, with different number of steps using the second order Trotter formula ('T+V+T'). Exact ground state and exact application of the transition operator $\hat{O}$ are used here. }
\end{center}\end{figure}


\section{Noise}
\label{sec:noise}

In this section, we present an analysis performed on the quantum circuit through both statevector and noisy simulations. The circuit implements quantum phase estimation using second-order Trotter method to execute controlled time evolutions. It comprises a total of 15 qubits, nine are allocated for the target state and six are used as ancillary qubits. The total gate count of such circuit is $2\times 10^{5}$ CNOTs and $1.37\times 10^{5}$ Z-rotations, corresponding to a total of $126$ Trotter steps. We initialize the target register to the classically computed exact ground state using the IBM Qiskit~\cite{Qiskit} initialize function. The function implements the state preparation algorithm developed in Ref.~\cite{Shende2006}, resulting in a circuit having $510$ CNOTs and $2,035$ Z-rotations. The initialization circuit has negligible overall gate count compared to full's circuit total gate count. To assess the impact of errors of two qubit gates we introduce a depolarizing error channel for each of the two-qubit gates (CNOT) within the circuit. The intensity of the error is systematically varied to evaluate its effects on the quality of the response function, utilizing the IBM Qiskit error modeling framework. For each value of the depolarizing error channel, we performed one thousand simulations to compute the average and variance estimators for the corresponding results. These simulations were conducted using the U.S. OLCF Andes HPC cluster, allocating one node per depolarizing error value. Each node's thousand simulations were distributed across its 32 cores.  The results are shown in Fig.~\ref{fig:noise_res_v0}.  We observe a marked degradation of the quality of the response function when the depolarizing error channel reaches $5\times 10^{-4}$. While a depolarizing error value of $10^{-5}$ still allows to recognize the peak position, the error in the peak strength is considerable.


\begin{figure} \begin{center}  %[!htb]
%    \centering
    \begin{tikzpicture}
        \node[anchor=south west,inner sep=0] (image) at (0,0) {\includegraphics[width=\linewidth]
{noise_response_function.pdf}};
        \begin{scope}[x={(image.south east)},y={(image.north west)}]
            \node[anchor=south west,inner sep=0] (image) at (0.25,0.47) {\includegraphics[width=4.0cm]{INSET_noise_response_function.pdf}};
            \end{scope}
    \end{tikzpicture}
    \caption{\label{fig:noise_res_v0} 
    Results for the response function including depolarizing error channel for each of the two qubit gates in the circuit, and using $W=6$, $\alpha=1$, $\beta=0$ and second-order Trotter formula ('T+V+T'). Depolarizing error values are reported in the legend.
    The inset shows the same results with a focus around the QE peak.
}
\end{center} \end{figure}


\section{Summary}
\label{sec:summary}

To summarize, we have studied here the description of reactions, and specifically response functions, in quantum systems using quantum algorithms on a lattice. We focused on a qubit-efficient mapping in momentum space and discussed its advantages for small systems compared to the JW mapping with respect to the number of qubits and number of Pauli strings in the Hamiltonian.

Focusing on the two-body nuclear case with a contact interaction, we studied this approach in detail. We have shown that efficient circuits, with significant cancellation of CNOT gates, can be constructed for time propagation using the Trotter approximation. This shows that the large entanglement between the qubits in the qubit-efficient mapping does not necessarily translates to deep circuits. We have also demonstrated the advantage of second-order Trotter approximation over the first-order approach in this problem.

For ground state preparation we have investigated two possible methods, involving either energy filter approach or a direct state initialization assuming the ground-state wave function is known. The latter approach seems favorable for small systems, where indeed ground-state calculations can be performed classically, but dynamics are still beyond reach. 

Finally, we have focused on the calculation of inclusive response functions using a QPE-based algorithm with modifications relevant for quasi-elastic reactions. Studying the number of required Trotter steps, we have concluded that a circuit with an order of $10^5$ gates is required to obtain a reliable calculation for the two-body case. We also discussed possible approaches to reduce the circuit depth.

Future studies should extend this work to heavier systems and more realistic interactions. Finite range interactions and spin-isospin dependence (for nuclear systems) should be considered, as well as three-body forces. 
Additional mappings can also be considered. In this context, a recent work \cite{Watson:2023oov} should be mentioned, in which specific second-quantization mappings were used to describe similar systems with a contact interaction, leading to parallelization and reduction in circuit depth (but not necessarily in the total number of one-body and two-body gates, and requiring more qubits). Detailed comparison with this approach and a study of the different trade-offs is required.
Other available algorithms for inclusive response functions should also be considered, together with developing algorithms for exclusive reactions, where, e.g., a particle is knocked out of the system and its momentum is measured.
Making such a progress, alongside advancements in quantum hardware, can open the path for first application of quantum computers for calculations of exclusive response functions in few-body systems, e.g. for lepton-nucleus reactions, not accessible by classical computers and relevant for various experimental efforts.




\section*{Acknowledgments}

 This work was carried out under the auspices of the National Nuclear Security Administration of the U.S. Department of Energy at Los Alamos National Laboratory under Contract No. 89233218CNA000001, and Oak Ridge Leadership Computing Facility at the Oak Ridge National Laboratory, which is supported by the office of Science of the U. S. Department of Energy under contract No. DE-AC05-00OR22725. IS and JC gratefully acknowledge support by the Los Alamos Information Science and Technology Institute Rapid Response program and by the Advanced Simulation and Computing (ASC) program. ABs work is supported by the U.S. Department of Energy, Office of Science, Nuclear Physics Quantum Horizons initiative, as is part of JC's work. This work was partially funded by the U. S. Department of Energy, Office of Science, Advanced Scientific Computing Program Office under FWP ERKJ382. 
 JC and AB also acknowledge the Quantum Science Center
 for partial support of their work on this project.
 The work of RW was supported by the Laboratory Directed Research and Development program of Los Alamos National Laboratory under project number 20210763PRD1.

% =====================================
% APPENDIX
% =========================================
\appendix

\section{Order of basis states}
\label{sec:app_order_states}

In the qubit-efficient mapping discussed in this work, each basis state is mapped to a bit-string of $n_q$ digits. We order the basis states in a specific order and map each state to the corresponding string, organized in the binary order. The order of the basis states can impact the resulting number of Pauli strings in the Hamiltonian. 

In this work, we organize the momentum-space two-body basis states $|\bs{k},\bs{-k}\rangle$ in the following way. First, the allowed $k_x$ values are organized in this order: 
$\{0, \frac{2\pi}{L_x},2\frac{2\pi}{L_x},...,(\frac{N_x}{2}-1) \frac{2\pi}{L_x}, -\frac{N_x}{2} \frac{2\pi}{L_x} ,-(\frac{N_x}{2}-1)\frac{2\pi}{L_x},...,-\frac{2\pi}{L_x}\}$, and similarly for $k_y$ and $k_z$. Then, the three-dimensional vectors $|\bs{k}\rangle$ are organized in the following order. We choose the first value of $k_x$, $k_y$ and $k_z$, i.e., the zero-momentum state. Then, the values of $k_x$ and $k_y$ are fixed, and the value of $k_z$ is changed according to the above order. Once we go aver all values of $k_z$, the value of $k_y$ is changed to the next one, and we go again over all $k_z$ values. Once we go over all $k_y$ values in this way, we change the value of $k_x$ to the next one, and go again over all values of $k_y$ and $k_z$ in this way, etc. This defines the order of the basis states $|\bs{k},\bs{-k}\rangle$ used in this work.


\section{Energy filter - technical details}
\label{sec:app_energy_filter}

To apply the algorithm discussed in Section \ref{subsec:energy_filter} on a quantum computer, a Trotter approximation can be used for the time evolution operator $\exp[-i({\cal H}-E_0 I_N) t_\Delta \otimes Y_a]$. Similar to the discussion in Section \ref{sec:time_evo}, we can separate the operator $({\cal H}-E_0 I_N) \otimes Y_a$ to two operators: $(T-E_0 I_N)\otimes Y_a$ and $V \otimes Y_a$. Each of these two operators translates to a sum of commuting Pauli strings in the mapping we employ in this work. We can thus use the Trotter approximation, similar to Eqs. \eqref{eq:1st_trotter} and \eqref{eq:2nd_trotter}. 

To implement this approach, we can follow the same idea of the Grey-Code order discussed in Section \ref{sec:time_evo} with slight modifications. The operator $V \otimes Y_a$ can be diagonalized, 
\be \label{eq:VY_diag}
V \otimes Y_a = \left[ H^{\otimes n_q}\otimes S_a H_{a} \right] \left[ D\otimes Z_a \right] \left[ H^{\otimes n_q} \otimes H_{a} S_a^\dagger \right],
\ee
where $D$ was defined after Eq. \eqref{Eq:VtoD}, the subscript $a$ denotes the ancillary qubit, and $S$ is the $S$ phase gate. Therefore, in a single Trotter step, the operator $\exp[-i V\otimes Y_a \delta t]$, can be implemented with the appropriate diagonalizing gates at the beginning and at the end of the circuit, while the time propagation involves the operator $D$, mapped to all Pauli strings with $I$ and $Z$ matrices, and a fixed $Z$ for the ancillary qubit. Using the Grey-Code order for the Pauli strings and considering the cancellations of CNOTs we obtain a circuit with $512$ CNOTs and $512$ Z-rotations (including the all-$I$ string). For the $(T-E_0 I_N)\otimes Y_a$ operator, only $Y_a$ should be diagonalized and an optimized circuit involves $24$ CNOTs and 19 $Z$-rotations. Therefore, if we use first-order approximation, Eq. \eqref{eq:1st_trotter}, each Trotter step involves $536$ CNOTs and $531$ $Z$-rotations. For $40$ step, this is $21440$ CNOTs and $21240$ $Z$-rotations. Second-order approximations, Eq. \eqref{eq:2nd_trotter}, results in only $24$ more CNOTs and 19 more $Z$-rotations for the whole time evolution.

\section{State initialization algorithm - technical details}
\label{sec:app_state_ini}

We provide here more technical detailed regarding the algorithm presented in Section \ref{subsec:initialization}.
As discussed, we assume to know the expansion of the desired state $|\Psi_0 \rangle$ using the basis states $\{|v_j\rangle \}$ and coefficients $\{g_j\}$ (Eq. \eqref{eq:gs_expan}).
The computer is initialized to the state $|\psi_i\rangle$, given in Eq. \eqref{eq:ini_state_bj}, with  {\it real} non-zero coefficients $\{b_j\}$.
In our mapping this corresponds to a state that includes all $2^{n_q}$ bit-string combinations. If the computer is initialized to the state where all qubits are in the $|0\rangle$ state, $|\psi_i\rangle$ can be created, for example, by applying the Hadamard gate on each qubit, resulting in $b_j=1/\sqrt{2^{n_q}}$ for all $j$. Other states can also be created by applying a $Y$-rotation on each qubit, for example. 

Next, the operator $\exp[-i Q \otimes Y_a]$ is applied on the state $|\psi_i\rangle \otimes |0\rangle$, using ancillary qubit $a$. $Q$ is defined in Eq. \eqref{eq:Q_op} as the diagonal Hermitian opertaor $Q = \sum_j d_j |v_j\rangle \langle v_j|$. It includes only Pauli strings with $I$ and $Z$ matrices when mapped to qubits, see Eq. \eqref{eq:mapping}.
If we measure the ancillary qubit in state $|0\rangle$, we obtain the state $|\psi_Q\rangle \equiv {\cal N}\cos(Q)|\psi_i \rangle$, where ${\cal N}$ is an appropriate normalization factor.
Since $Q$ is diagonal, this state can be written as
\be
|\psi_Q \rangle = {\cal N} \sum_j \cos(d_j) b_j |v_j \rangle.
\ee
We can now choose the values of $d_j$ such that 
\be \label{eq:d_values}
\cos(d_j) = \gamma \frac{|g_j|}{b_j},
\ee
for all $j$. $\gamma$ is a $j$-independent real and positive number. Notice that we must use the absolute value of $g_j$, because $\cos(d_j)$ is a real number. With this choice, we get ${\cal N} = 1/\gamma$, because $\sum_j |g_j|^2 =1$, and 
\be
|\psi_Q \rangle = \sum_j |g_j| |v_j \rangle.
\ee
This is very close to the desired state $|\Psi_0\rangle$. We are only missing the phases of the coefficients. Before accounting for the phases, notice that, in order to satisfy Eq. \eqref{eq:d_values}, we must have 
\be
\gamma \left|\frac{g_j}{b_j} \right| \leq 1
\ee
for all $j$.
The success probability, i.e., the probability to measure the ancillary qubit in state $|0\rangle$ and obtain the state $|\psi_Q\rangle$, is given by 
\be
P = \langle \psi_i | \cos^2(Q)|\psi_i \rangle = \sum_j cos^2(d_j) b_j^2 = \gamma^2.
\ee
Therefore, to maximize the success probability we need to maximize the value of $\gamma$. The largest possible value of $\gamma$ is
\be
\gamma_{max} \equiv \min\left\{ \left| \frac{b_j}{g_j}\right| \right\}.
\ee
Therefore, when creating the state $|\psi_i\rangle$ with coefficients $\{b_j\}$, one should try to maximize the value of $\gamma_{max}$. Notice that $\gamma_{max}\leq 1$ because there must be at least one $j$ for which $|b_j|\leq|g_j|$ (because both $|\Psi_0\rangle$ and $|\psi_i\rangle$ are normalized to 1). If we choose to create $|\psi_i\rangle$ using the Hadamard gates, then we get $P \geq 1/2^{n_q}$ (because $|g_j|\leq 1$). 

Now, in order to obtain $|\Psi_0\rangle$ from $|\psi_Q\rangle$, we define the Hermitian diagonal operator
\be
\Theta = \sum_j \theta_j |v_j\rangle \langle v_j|, 
\ee
where $g_j=|g_j|\exp(i\theta_j)$. Applying the operator $\exp(i\Theta)$ on $|\psi_Q\rangle$, we obtain
\be
\exp(i\Theta) |\psi_Q\rangle
= \sum_j e^{i\theta_j} |g_j| |v_j\rangle = |\Psi_0\rangle.
\ee
Indeed, we obtained the state $|\Psi_0\rangle$. If all $\{g_j\}$ are real numbers, this step is not necessary (and $g_j$ should be used instead of $|g_j|$ in Eq. \eqref{eq:d_values}).
As discussed in Section \ref{subsec:initialization}, exact implementation of this algorithm requires at most $2^{n_q}$ CNOTs and $2^{n_q}$ $Z$-rotations if the coefficients $\{g_j\}$ are all real (similar to Eq. \eqref{eq:VY_diag} and the discussion around it). Generally, it requires at most 
at most $2^{n_q+1}-2$ CNOTs and $2^{n_q+1}-1$ $Z$-rotations in total. As also discussed in Section \ref{subsec:initialization}, a reduced number of gates is obtained if an approximate implementation is sufficient.

We can examine the gate count and success probability of this algorithm for our $9$-qubit two-body case. 
If the initial state $|\psi_i\rangle$ is created with Hadamard gates as described above, i.e. $b_j=1/\sqrt{2^{n_q}}$,
the success probability is guaranteed to be at least $1/2^9\approx 0.002$. For the two-body ground state, the success probability is actually $\approx 0.0026$, i.e. successful result once in about every $385$ tries in average. But, this can be significantly improved. 
Starting with the all-zero $9$-bit state, we apply single qubit $Y$-rotation gates on all qubits, with the same rotation angle $\theta$. As a result, all bit strings are created. The amplitude of each string is equal to $\cos^{9-p}(\theta/2) \sin^p(\theta/2)$, where $p$ is the number of $1$'s in the string.  $\theta$ can be chosen to maximize success probability. With the same mapping used in the sections above, we obtain $P\approx 0.03$, i.e. success about every 33 tries in average. This is indeed much larger than $1/2^{n_q}$.
We can increase the success probability even more by using a slightly different mapping. 
We start by organizing the basis momentum states according to their total momentum magnitude, from smallest to largest. Then, they can be mapped to bit strings, such that the first state, i.e. the zero momentum state, is mapped to the all-zero $9$-bit string. The next 9 states are mapped to strings with a single $1$ digit and $8$ zeros. The following states are mapped to strings with two $1$'s, etc. 
Applying single qubit $Y$-rotations on the all-zero $9$-bit state, and optimizing the angle, gives in this case $P\approx 0.14$, i.e. success every 7 tries in average. We do note that using this latter mapping results in more Pauli strings in the mapping of the kinetic energy. 

As mentioned above, following Ref. \cite{Welch_2014}, an approximated state can be created with a shorter quantum circuit. This is obtained by omitting Pauli strings with small coefficients in the operator $Q$. For example, if we use the last mapping described above, and omit all Pauli strings with coefficients smaller than $0.002$, we are left with $300$ strings out of the initial $512$ strings. Under this approximation, applying $\exp[-i Q \otimes Y_a]$ will involve only $300$ $Z$-rotations and a similar number of CNOTs \cite{Welch_2014}, compared to the $512$ $Z$-rotations and CNOTs for the exact case. Under this approximation, the energy of the state differs by only $10\%$ from  the exact ground state.

\section{Modified response-function algorithm}
\label{sec:app_modified_QPE}

In the modified response function algorithm discussed in Section \ref{sec:res_func}, the relevant operators are given in Eq. \eqref{eq:QPE_mod_op}. We consider here the case of $\beta=0$ for simplicity. The total "time" evolution, assuming $W_\alpha$ ancillary qubits, is given by
\be
t_{tot} =
2\pi\alpha \sum_{k=0}^{W_\alpha-1} 2^k = 2\pi \alpha(2^{W_\alpha}-1).
\ee
We can consider $\alpha=2^n$ for integer $n\geq 0$. The relevant energy domain in which the response function is evaluated is then $[0,1/2^n]$, compared to the range $[0,1]$ in the original algorithm, i.e., $\alpha=1$. Therefore, to obtain the same energy resolution as the case of $W_1$ ancillary qubits with $\alpha=1$, we can use $W_{2^n} = W_1-n$ anciallry qubits with $\alpha=2^n$ (because the number of energy grid points is $2^W$). This is the reduction in the number of ancillary qubits that we get in the modified approach (keeping the same resolution), if we know the response function is negligible outside some energy range. Substituting it to the total time evolution, we get (for $\alpha=2^n$ and $W_{2^n} = W_1-n$)
\be
t_{tot} =
%2\pi 2^n (2^{W_1}/2^n-1) =
2\pi  (2^{W_1}-2^n) =
2\pi  (2^{W_1}-\alpha).
\ee
This can be compared to the total time evolution for the original case, i.e. for $\alpha=1$ and $W_1$ ancillary qubits
\be
t_{tot} = 2\pi(2^{W_1}-1).
\ee
We can see that we get a reduction in the total time (because $\alpha>1$), on top of the reduction in the number of ancillary qubits. Notice, however, that the reduction in time is by a factor smaller than $2$ (because $n\leq W_1 -1$, to keep $W_{2^n} \geq 1$).



\bibliography{references}

%\input{supplement-ver2}


\end{document}


