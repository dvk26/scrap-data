\section{Discussion of related work}\label{sec:discussion}


\emph{Cost analysis in type theory.}
The original motivation for proving internal, cost-sensitive computational adequacy results grew out of the work of Niu \etal{}~\cite{niu-sterling-grodin-harper:2022} on formalizing cost analysis of functional programs in dependent type theory. Niu and Harper~\cite{niu-harper:2023} prove such an adequacy theorem for a variant of the Algol language featuring a notion of first-order recursion in the form of while loops. The purpose of the present paper is to generalize that result to account for higher-order recursion. In contrast to both prior works, we have de-emphasized the role of the call-by-push-value language and instead work directly with the internal language of the SDT topos. Because the model we construct in \cref{sec:model} can also be seen as a model for the type theories in both prior works, we expect that it would be routine to formalize our results in a call-by-push-value version of type theory as well. 

\emph{Cost-sensitive computational adequacy.}
The kind of cost-sensitive adequacy theorem we prove in this paper has been proved in a classic domain-theoretic setting by Kavvos \etal{}~\cite{kavvos-morehouse-licata-danner:2019}, and the general theory of computational adequacy for languages with algebraic effects has been developed by Plotkin and Power~\cite{plotkin-power:2002}. The main difference between our work and those mentioned is that we aim to prove adequacy results internally to a type theory equipped with a phase distinction (such as the one in Niu \etal{}~\cite{niu-sterling-grodin-harper:2022}). As argued in Niu and Harper~\cite{niu-harper:2023}, such internal adequacy theorems can be used as a basis for the validity of axiomatic cost analysis in these type theories. 

\input{jon-related}

\emph{Computational adequacy in SDT.} 
Our approach to internal denotational semantics and computational adequacy of \pcfc{} builds on the pioneering work of Simpson~\cite{simpson:1999} on proving the computational adequacy property of \pcf{} in elementary topoi models of SDT. One difference between our work and that of \opcit{} is the addition of the phase distinction, which we use to give an intrinsic denotational account of the interaction between cost and behavior in \pcfc{}. Another difference is in the SDT axioms used and the ensuing definition of the dynamic semantics of the object programming language. Simpson~\cite{simpson:1999} assumes a property called \emph{Axiom N} that closes the dominance $\Sigma$ under countable joins of decidable families in the ambient logic, a fact that we do not rely on in our constructions. The benefit of this axiom is that it enables \opcit{} to give an internal definition of \pcf{} whose dynamic semantics can be characterized by means of existentially quantified statements of the form $\some{n : \Nat} \phi(n)$ where $\phi$ is a primitive recursive predicate. This is used to show that a general property of the internal logic of topoi called \emph{1-consistency}\footnote{A topos $\mathcal{E}$ is \emph{1-consistent} when a closed formula $\some{n : \Nat} \phi(n)$ of the form described above holding in the internal logic of $\CatIdent{E}$ implies that it holds externally.} is both necessary and sufficient to \emph{externalize} the internal adequacy proof into a corresponding proof in ordinary mathematics. In a follow-up paper, Simpson~\cite{simpson:2004} gave a different logical criterion for the equivalence of internal and external adequacy called \emph{computational 1-consistency} that does not rely on Axiom N. Roughly the idea is to define the programming language and its operational semantics in terms of the \emph{computational natural numbers} (analogous to the predomain $\NatP$ in this paper); computational 1-consistency is just the property needed to ensure that internal computational observations hold externally as well.

By contrast, the dynamic semantics of \pcfc{} in this paper is defined \emph{computationally} and is not known to be equivalent to the operational semantics of Simpson~\cite{simpson:1999} in the absence of Axiom N. However, we expect that a version of our computational semantics using the computational natural numbers will be equivalent to the semantics given in Simpson~\cite{simpson:2004}. On the other hand, we find the computational semantics developed in \cref{sec:comp-sem} both philosophically and mathematically compelling and deserving of further investigation in its own right. Moreover, although the computational semantics of \pcfc{} does not appear to be definable in terms of countable joins, it can be defined using \emph{synthetic} $\omega$-joins of decidable families. Therefore, we conjecture that one may externalize the internal adequacy proof of \pcfc{} in the manner of Simpson~\cite{simpson:1999} by developing a Kripke-Joyal semantics for the sheaf model defined in \cref{sec:model} that unfolds an internal statement involving synthetic $\omega$-joins to an external statement in the metatheory. 
